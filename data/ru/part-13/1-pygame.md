---
path: '/ru/part-13/1-pygame'
title: 'Pygame'
hidden: false
---

<text-box variant='learningObjectives' name="Цели обучения">

После этого раздела

- Вы установите библиотеку pygame на свой компьютер
- Вы будете знать, как создать окно pygame и как выйти из программы
- Вы сможете использовать изображение, сохранённое в файле, в окне pygame

</text-box>

В этих последних двух частях курса мы познакомимся с библиотекой pygame. Это библиотека Python для программирования игр. Она помогает создавать графические элементы, обрабатывать события от клавиатуры и мыши, а также реализовывать другие функции, необходимые в играх.

## Установка pygame

### Linux

Откройте командную строку, введите `pip3 install pygame` и нажмите `enter`.

<img src="../../part-13/pygame_linux.png">

Это должно установить библиотеку pygame на ваш компьютер.

### Windows

Откройте терминал Windows, открыв меню, введя `cmd` и нажав `enter`:

<img src="../../part-13/13_1_1.png">

Должно открыться окно интерпретатора командной строки. Введите `pip3 install pygame` и нажмите `enter`.

Это должно установить библиотеку pygame на ваш компьютер.

Установка может потребовать прав системного администратора. Если вышеописанное не работает, вы можете попробовать запустить приложение терминала от имени администратора: откройте меню Windows, найдите приложение CMD, щёлкните по нему правой кнопкой мыши и выберите "Запуск от имени администратора".

Установка и доступ к pygame требует, чтобы ваша установка Python была добавлена в PATH, как указано [здесь](https://www.mooc.fi/en/installation/vscode/#python3).

### Mac

Откройте _Терминал_, например, через символ лупы в правом верхнем углу:

<img src="../../part-13/13-1-2.png">

Должен открыться инструмент поиска. Введите `terminal` и нажмите `enter`:

<img src="../../part-13/13-1-3.png">

Введите следующее и нажмите `enter`:

`pip3 install pygame`

<img src="../../part-13/13-1-4.png">

Это должно установить библиотеку pygame на ваш компьютер.

## Ваша первая программа

Вот простая программа для проверки правильности установки pygame:

```python
import pygame

pygame.init()
window = pygame.display.set_mode((640, 480))

window.fill((0,0,0))
pygame.display.flip()

while True:
    for event in pygame.event.get():
        if event.type == pygame.QUIT:
            exit()
```

При запуске эта программа должна отобразить окно:

<img src="../../part-13/pygame_first.gif">

Программа состоит только из отображения окна, и она работает до тех пор, пока пользователь не закроет окно.

Рассмотрим более подробно шаги, необходимые для достижения этого. Первая строка подключает библиотеку pygame: `import pygame`. Следующая команда `pygame.init` инициализирует модули pygame, а следующая создаёт окно с помощью функции `pygame.display.set_mode`.

```python
pygame.init()
window = pygame.display.set_mode((640, 480))
```

Функция `set_mode` принимает размеры окна в качестве аргумента. Кортеж `(640, 480)` указывает, что окно имеет ширину 640 пикселей и высоту 480 пикселей. Имя переменной `window` может быть использовано позже для доступа к окну, например, для рисования в нём.

Следующие две команды делают именно это:

```python
window.fill((0, 0, 0))
pygame.display.flip()
```

Метод `fill` заполняет окно цветом, переданным в качестве аргумента. В этом случае цвет чёрный, переданный как RGB значение в кортеже `(0, 0, 0)`. `pygame.display.flip` обновляет содержимое окна.

После этих команд инициализации начинается _главный цикл_ программы:

```python
while True:
    for event in pygame.event.get():
        if event.type == pygame.QUIT:
            exit()
```

Главный цикл обрабатывает все события, которые операционная система передаёт программе. На каждой итерации функция `pygame.event.get` возвращает список всех событий, собранных с предыдущей итерации.

В примере выше программа обрабатывает только события типа `pygame.QUIT`. Это событие возникает, например, при нажатии на кнопку выхода в углу окна. Если событие `pygame.QUIT` возникает, программа завершается через функцию `exit`.

Вы можете попробовать и посмотреть, что произойдёт, если ваша программа не обрабатывает событие `pygame.QUIT`. Это должно означать, что нажатие на кнопку выхода ничего не делает, что было бы запутанно для пользователя. Поскольку программа запускается из командной строки, вы всё ещё можете остановить её из командной строки с помощью Control+C.

## Добавление изображения

Добавим изображение в окно:

```python
import pygame

pygame.init()
window = pygame.display.set_mode((640, 480))

robot = pygame.image.load("robot.png")

window.fill((0, 0, 0))
window.blit(robot, (100, 50))
pygame.display.flip()

while True:
    for event in pygame.event.get():
        if event.type == pygame.QUIT:
            exit()
```

Программа использует это изображение робота, которое сохранено в файле `robot.png`:

<img src="../../part-13/robot.png">

Файл `robot.png` должен находиться в том же каталоге с исходным кодом вашей программы, иначе программа не сможет его найти. В шаблонах упражнений для этой части изображения ожидают в каталоге упражнения.

Теперь окно должно выглядеть так:

<img src="../../part-13/pygame_pic.gif">

Функция `pygame.image.load` загружает изображение из файла `robot.png` и сохраняет ссылку на него в переменной с именем `robot`. Метод `blit` рисует изображение в местоположении `(100, 50)`, а функция `pygame.display.flip` обновляет содержимое окна, как и раньше. Местоположение `(100, 50)` означает, что _левый верхний угол_ изображения находится в этом местоположении внутри окна.

В pygame точка начала координат `(0, 0)` находится в левом верхнем углу окна. Координаты x увеличиваются вправо, а координаты y увеличиваются вниз, так что правый нижний угол имеет координаты `(640, 480)`. Это противоположно тому, как обычно обрабатываются координаты, например, в математике, но это довольно распространено в контексте программирования, и к этому стоит привыкнуть.

После загрузки изображения вы можете использовать его много раз в одном окне. Следующий код рисует изображение робота в трёх разных местах:

```python
window.blit(robot, (0, 0))
window.blit(robot, (300, 0))
window.blit(robot, (100, 200))
```

В результате окно должно выглядеть так:

<img src="../../part-13/pygame_pic2.gif">

Здесь мы устанавливаем местоположение изображения так, чтобы оно находилось в центре окна:

```python
width = robot.get_width()
height = robot.get_height()
window.blit(robot, (320-width/2, 240-height/2))
```

Теперь окно должно выглядеть так:

<img src="../../part-13/pygame_pic3.gif">

Метод `get_width` возвращает ширину изображения, а метод `get_height` возвращает его высоту, обе в пикселях. Центр окна находится на половине его ширины и высоты, то есть в `(320, 240)`, что мы можем использовать для вычисления подходящего местоположения для левого верхнего угла изображения, чтобы оно лежало точно в центре.

<text-box variant='hint' name='Упражнения Pygame'>

В упражнениях этой части курса нет автоматических тестов, поскольку результаты проверяются визуально. Тесты автоматически предоставляют очки при отправке решения на сервер, независимо от вашей реализации. Отправляйте решение только тогда, когда оно готово, и ваше решение соответствует описанию упражнения. В упражнениях может не быть автоматических тестов, но преподаватели курса всё равно будут видеть ваше решение. Также отправка неполного решения в TMC Paste автоматически предоставляет очки, поэтому это не следует использовать при просьбе о помощи с упражнениями в этой части. Вы можете использовать [Pastebin.com](https://pastebin.com/) или какой-либо другой интернет-сервис pastebin при просьбе о помощи в каналах поддержки курса.

Если ваше решение явно не соответствует описанию упражнения, вы можете потерять очки, предоставленные за упражнения в этой части.

</text-box>

<programming-exercise name='Four robots' tmcname='part13-01_four_robots'>

Пожалуйста, напишите программу, которая рисует робота в каждом из четырёх углов окна. Конечный результат должен выглядеть так:

<img src="../../part-13/pygame_four.gif">

</programming-exercise>

<programming-exercise name='Robots in a row' tmcname='part13-02_robots_row'>

Пожалуйста, напишите программу, которая рисует десять роботов в ряд. Конечный результат должен выглядеть так:

<img src="../../part-13/pygame_row.gif">

</programming-exercise>

<programming-exercise name='A hundred robots' tmcname='part13-03_hundred_robots'>

Пожалуйста, напишите программу, которая рисует сто роботов: десять рядов по десять роботов в каждом ряду. Конечный результат должен выглядеть так:

<img src="../../part-13/pygame_hundred.gif">

</programming-exercise>

<programming-exercise name='Random robots' tmcname='part13-04_random_robots'>

Пожалуйста, напишите программу, которая рисует _тысячу_ роботов в случайных местах. Конечный результат должен выглядеть так:

<img src="../../part-13/pygame_thousand.gif">

</programming-exercise>